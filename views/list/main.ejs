<%- partial('partials/header')%>
<div class="container" style="position:relative">
	<div class="ui grid">
		<div class="column l-leftcolumn">
			<a href="/new" class="ui basic fluid button">
				<i class="add icon"></i>
				Новый тикет
			</a>
			<%- partial('partials/filter')%>
		</div>
		<div id="l-content" class="column l-rightcolumn" style="display: inline-block;margin-top: 2em;">
			<div class="ui selection list">
				<% tickets.forEach(function(ticket) { %>
				<div class="item" style="color:inherit;padding:0;border-top: 1px solid rgba(0, 0, 0, 0.1);">
					<div class="right floated t-status <%= ticket.status.class %>" style="padding:1em 0.5em;"><%- ticket.status.text %></div>
					<a class="content gc-nostylelink" style="display:block;padding: 0.2em 0em;" href="/id/<%= ticket.id %>">
						<div class="header"><span style="font-weight: 400;">#<%= ticket.id %>:</span> <%= ticket.title %></div>
						<div class="description" style="font-size: 0.9em;">
							<i class="<%= ticket.visibility.class %> icon" title="<%= ticket.visibility.text %>"></i>
							<i class="user small icon"></i><%= ticket.owner %>
							<span title="<%= moment(ticket.createdAt).format('Do MMM YYYY, h:mm') %>"><i class="time small icon"></i><%= moment(ticket.createdAt).fromNow() %></span>
							<i class="comment small icon"></i><%= ticket.commentsCount %>
						</div>
					</a>
				</div>
				<% }) %>
			</div>
			<div class="gc-center" style="margin-top: 3em !important;">
				<div class="ui pagination menu">
					<a href="/<%= type.url %>/1<%= query %>" class="item <% if (currentPage === 1) { %>active<% } %>">
						1
					</a>
					<% if (lastPage >= 2) { %>
					<a href="/<%= type.url %>/2<%= query %>" class="item <% if (currentPage === 2) { %>active<% } %>">
						2
					</a>
					<% } %>
					<% if (lastPage >= 3) { %>
					<a href="/<%= type.url %>/3<%= query %>" class="item <% if (currentPage === 3) { %>active<% } %>">
						3
					</a>
					<% } %>
					<% if (currentPage >= 3 || currentPage < lastPage - 2 || currentPage <= lastPage - 2) { %>
					<% if (currentPage - 1 !== 3 && (currentPage - 1 >= 3)) { %>
					<% if (!(currentPage - 2 === 3)) { %>
					<div class="disabled item">
						...
					</div>
					<% } %>
					<% if (!(currentPage - 1 >= lastPage - 2 )) { %>
					<a href="/<%= type.url %>/<%= currentPage - 1 %><%= query %>" class="item">
						<%= currentPage - 1 %>
					</a>
					<% } %>
					<% } %>
					<% if (!(currentPage >= lastPage - 2) && (currentPage > 3)) { %>
					<a href="/<%= type.url %>/<%= currentPage %><%= query %>" class="item active">
						<%= currentPage %>
					</a>
					<% } %>
					<% if (!(currentPage + 1 >= lastPage - 2)) { %>
					<% if (currentPage >= 3) { %>
					<a href="/<%= type.url %>/<%= currentPage + 1 %><%= query %>" class="item">
						<%= currentPage + 1 %>
					</a>
					<% } %>
					<% if (currentPage + 1 >= 2) { %>
					<div class="disabled item">
						...
					</div>
					<% } %>
					<% } %>
					<% } else if (lastPage > 4) { %>
					<div class="disabled item">
						...
					</div>
					<% } %>
					<% if (lastPage - 2 >= 5) { %>
					<a href="/<%= type.url %>/<%= lastPage - 2 %><%= query %>" class="item <% if (currentPage === lastPage - 2) { %>active<% } %>">
						<%= lastPage - 2 %>
					</a>
					<% } %>
					<% if (lastPage - 1 >= 5) { %>
					<a href="/<%= type.url %>/<%= lastPage - 1 %><%= query %>" class="item <% if (currentPage === lastPage - 1) { %>active<% } %>">
						<%= lastPage - 1 %>
					</a>
					<% } %>
					<% if (lastPage >= 5) { %>
					<a href="/<%= type.url %>/<%= lastPage %><%= query %>" class="item <% if (currentPage === lastPage) { %>active<% } %>">
						<%= lastPage %>
					</a>
					<% } %>
				</div>
			</div>
		</div>
	</div>
</div>
